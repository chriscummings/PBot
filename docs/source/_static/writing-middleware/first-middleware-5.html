<pre><code class="language-python">
def handle_messages(self, messages: list[dict]) -> list[dict]:

  # Sort earliest messages first
  messages.sort(key=lambda m: float(m['time']))

  for message in messages:

    # Don't respond to bot messages
    if int(message['user']['bot']) == 1:
      continue

    # Don't respond to already responded-to messages
    if message['response']:
      continue

    for keyword in self.KEYWORDS:

      # Respond if a keyword is found in the message
      if keyword.lower() in message['content'].lower():

        # Create a unique, arbitrary GUID for the response
        resp_id = f'taco{datetime.now().timestamp()}'

        # Create a response about the gospel of tacos
        create_response(
          self.redis,
          resp_id,
          random.choice(TACO_RECIPES),
          message["id"])

        # Move on to any additional messages
        break

  # Return message list to any follow-on middleware to handle.
  return messages

</code></pre>